{
  "type": "object",
  "definitions": {
    "path": {
      "type": "string",
      "pattern": "^.*$",
      "description": "Path value must be a valid string, empty strings are allowed but will generate a warning"
    }
  },
  "properties": {
    "CONFIG_VERSION": { "type": "string" },
    "_comments": { "type": "object" },
    "CPU_LIMIT": {
      "type": "integer",
      "minimum": 1,
      "description": "Maximum number of CPU cores to use for processing"
    },
    "TIMEKEEP": {
      "type": "boolean",
      "description": "Whether to log execution times"
    },
    "ignore": {
      "type": "object",
      "description": "Controls which modules to run (false) or ignore (true)",
      "properties": {
        "cord_loader": { "type": "boolean" },
        "downloader": { "type": "boolean" },
        "text_loader": { "type": "boolean" },
        "pubmed_bulk_loader": { "type": "boolean" },
        "splitter": { "type": "boolean" },
        "ner": { "type": "boolean" },
        "analysis": { "type": "boolean" },
        "merger": { "type": "boolean" },
        "metrics": { "type": "boolean" },
        "nel": { "type": "boolean" },
        "result_inspection": { "type": "boolean" }
      },
      "required": [
        "cord_loader",
        "downloader",
        "text_loader",
        "pubmed_bulk_loader",
        "splitter",
        "ner",
        "analysis",
        "merger",
        "metrics",
        "nel",
        "result_inspection"
      ]
    },
    "downloader": {
      "type": "object",
      "properties": {
        "input_path": { "$ref": "#/definitions/path" },
        "output_path": { "$ref": "#/definitions/path" },
        "batch_size": { "type": "integer" }
      },
      "required": ["input_path", "output_path", "batch_size"]
    },
    "cord_loader": {
      "type": "object",
      "properties": {
        "input_path": { "$ref": "#/definitions/path" },
        "output_path": { "$ref": "#/definitions/path" },
        "subset": { "type": "boolean" },
        "subset_file": { "$ref": "#/definitions/path" }
      },
      "required": ["input_path", "output_path", "subset"]
    },
    "text_loader": {
      "type": "object",
      "properties": {
        "input_path": { "$ref": "#/definitions/path" },
        "output_path": { "$ref": "#/definitions/path" },
        "prefix": { "type": "string" }
      },
      "required": ["input_path", "output_path", "prefix"]
    },
    "pubmed_bulk_loader": {
      "type": "object",
      "properties": {
        "output_path": { "$ref": "#/definitions/path" },
        "baseline": { "type": "string" },
        "subset": { "type": "boolean" },
        "subset_range": {
          "type": "array",
          "items": { "type": "integer" },
          "minItems": 2,
          "maxItems": 2
        },
        "get_nightly_update_files": { "type": "boolean" },
        "update_file_range": {
          "type": "array",
          "items": { "type": "integer" },
          "minItems": 2,
          "maxItems": 2
        },
        "count_articles": { "type": "boolean" },
        "raw_download_path": { "$ref": "#/definitions/path" }
      },
      "required": [
        "output_path",
        "baseline",
        "subset",
        "subset_range",
        "get_nightly_update_files",
        "update_file_range",
        "count_articles"
      ]
    },
    "splitter": {
      "type": "object",
      "properties": {
        "input_path": { "$ref": "#/definitions/path" },
        "output_folder": { "$ref": "#/definitions/path" },
        "output_file_prefix": { "type": "string" },
        "pubmed_bulk": { "type": "boolean" },
        "file_limit": {
          "oneOf": [
            {
              "type": "string",
              "enum": ["ALL"],
              "description": "Process all available files"
            },
            {
              "type": "array",
              "items": { "type": "integer" },
              "minItems": 2,
              "maxItems": 2,
              "description": "Process files with indices between [start, end] inclusive"
            }
          ]
        },
        "tokenizer": { "type": "string" },
        "model_name": { "type": "string" },
        "batch_size": { "type": "integer" }
      },
      "required": [
        "input_path",
        "output_folder",
        "output_file_prefix",
        "pubmed_bulk",
        "file_limit",
        "tokenizer",
        "model_name",
        "batch_size"
      ]
    },
    "ner": {
      "type": "object",
      "properties": {
        "input_path": { "$ref": "#/definitions/path" },
        "output_path": { "$ref": "#/definitions/path" },
        "output_file_prefix": { "type": "string" },
        "model_type": { "type": "string" },
        "model_folder": { "$ref": "#/definitions/path" },
        "model_name": { "type": "string" },
        "vocab_path": { "$ref": "#/definitions/path" },
        "store_tokens": { "type": "string" },
        "labels": { "type": "string" },
        "clear_old_results": { "type": "boolean" },
        "article_limit": {
          "type": "array",
          "items": { "type": "integer" },
          "minItems": 2,
          "maxItems": 2
        },
        "entity_type": { "type": "string" },
        "multiprocessing": { "type": "boolean" }
      },
      "required": [
        "input_path",
        "output_path",
        "output_file_prefix",
        "model_type",
        "model_folder",
        "model_name",
        "store_tokens",
        "clear_old_results",
        "article_limit",
        "entity_type",
        "multiprocessing"
      ]
    },
    "analysis": {
      "type": "object",
      "properties": {
        "input_path": { "$ref": "#/definitions/path" },
        "output_path": { "$ref": "#/definitions/path" },
        "entity_type": { "type": "string" },
        "plot_top_n": { "type": "integer" }
      },
      "required": ["input_path", "output_path", "entity_type", "plot_top_n"]
    },
    "merger": {
      "type": "object",
      "properties": {
        "paths": {
          "type": "array",
          "items": { "$ref": "#/definitions/path" }
        },
        "entities": {
          "type": "array",
          "items": { "type": "string" }
        },
        "output_path": { "$ref": "#/definitions/path" },
        "output_prefix": { "type": "string" }
      },
      "required": ["paths", "entities", "output_path", "output_prefix"]
    },
    "metrics": {
      "type": "object",
      "properties": {
        "predictions_file": { "$ref": "#/definitions/path" },
        "true_file": { "$ref": "#/definitions/path" },
        "output_file": { "$ref": "#/definitions/path" },
        "pred_sep": { "type": "string" },
        "true_sep": { "type": "string" }
      },
      "required": [
        "predictions_file",
        "true_file",
        "output_file",
        "pred_sep",
        "true_sep"
      ]
    },
    "nel": {
      "type": "object",
      "properties": {
        "input_path": { "$ref": "#/definitions/path" },
        "output_path": { "$ref": "#/definitions/path" }
      },
      "required": ["input_path", "output_path"]
    },
    "result_inspection": {
      "type": "object",
      "properties": {
        "input_folder": { "$ref": "#/definitions/path" },
        "output_file": { "$ref": "#/definitions/path" },
        "entities": {
          "type": "array",
          "items": { "type": "string" }
        }
      },
      "required": ["input_folder", "output_file", "entities"]
    }
  },
  "required": ["CPU_LIMIT", "TIMEKEEP", "ignore"]
}
